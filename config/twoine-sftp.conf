# =============================================================================
# TWOINE SFTP Configuration
# Place this file in: /etc/ssh/sshd_config.d/twoine-sftp.conf
# =============================================================================

# Match all users in the sftpusers group
Match Group sftpusers
    # Force SFTP subsystem only (no shell access)
    ForceCommand internal-sftp -u 0002 -l INFO
    
    # Chroot to /var/www/sites/<username>
    # Example: user "site_mysite" is chrooted to /var/www/sites/site_mysite
    ChrootDirectory /var/www/sites/%u
    
    # Disable all forwarding and tunneling (security)
    AllowTcpForwarding no
    X11Forwarding no
    PermitTunnel no
    AllowAgentForwarding no
    
    # Disable TTY allocation (no shell)
    PermitTTY no
    
    # Authentication settings
    PasswordAuthentication yes
    PubkeyAuthentication yes
    
    # Verbose logging for security auditing
    LogLevel VERBOSE
